pipeline {
agent any
  tools {nodejs "nodejs"}

  stages {
    stage('Example') {
      steps {
        sh 'npm config ls'
stages {
stage('Checkout') {
steps {
git branch: 'main', url: ' https://github.com/karlawd/8.1CDevSecOps.git'
}
}
stage('Install Dependencies') {
steps {
sh 'npm install'
}
}
stage('Run Tests') {
steps {
sh 'npm test || true' // Allows pipeline to continue despite test failures
}
}
stage('Generate Coverage Report') {
steps {
// Ensure coverage report exists
sh 'npm run coverage || true'
}
}
stage('NPM Audit (Security Scan)') {
steps {
sh 'npm audit || true' // This will show known CVEs in the output
}
}
}
}
